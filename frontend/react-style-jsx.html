<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>styled-jsx | 个人主页</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/logo.ico">
    <link rel="apple-touch-icon" href="/img/logo.png">
    <meta name="description" content="rh的博客">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;">
    
    <link rel="preload" href="/assets/css/0.styles.74a02103.css" as="style"><link rel="preload" href="/assets/js/app.f8839a88.js" as="script"><link rel="preload" href="/assets/js/2.8d06e467.js" as="script"><link rel="preload" href="/assets/js/52.2e105d94.js" as="script"><link rel="prefetch" href="/assets/js/10.75500dcd.js"><link rel="prefetch" href="/assets/js/11.592669c1.js"><link rel="prefetch" href="/assets/js/12.a9094538.js"><link rel="prefetch" href="/assets/js/13.2cf414ec.js"><link rel="prefetch" href="/assets/js/14.d2737ceb.js"><link rel="prefetch" href="/assets/js/15.8eb8f805.js"><link rel="prefetch" href="/assets/js/16.820d5c80.js"><link rel="prefetch" href="/assets/js/17.801ecbcc.js"><link rel="prefetch" href="/assets/js/18.b2f69842.js"><link rel="prefetch" href="/assets/js/19.15396bbe.js"><link rel="prefetch" href="/assets/js/20.233b2644.js"><link rel="prefetch" href="/assets/js/21.858bfdd0.js"><link rel="prefetch" href="/assets/js/22.38ba5211.js"><link rel="prefetch" href="/assets/js/23.58fbdc70.js"><link rel="prefetch" href="/assets/js/24.15131ce6.js"><link rel="prefetch" href="/assets/js/25.7bce4e07.js"><link rel="prefetch" href="/assets/js/26.b37e74b8.js"><link rel="prefetch" href="/assets/js/27.64d94c4d.js"><link rel="prefetch" href="/assets/js/28.c78dfbd6.js"><link rel="prefetch" href="/assets/js/29.b576a40d.js"><link rel="prefetch" href="/assets/js/3.f9317427.js"><link rel="prefetch" href="/assets/js/30.29554d88.js"><link rel="prefetch" href="/assets/js/31.9af67186.js"><link rel="prefetch" href="/assets/js/32.d380b09a.js"><link rel="prefetch" href="/assets/js/33.eb0839b0.js"><link rel="prefetch" href="/assets/js/34.62b518b9.js"><link rel="prefetch" href="/assets/js/35.429a5bce.js"><link rel="prefetch" href="/assets/js/36.43c4d349.js"><link rel="prefetch" href="/assets/js/37.d6b42aa3.js"><link rel="prefetch" href="/assets/js/38.a7eec5a0.js"><link rel="prefetch" href="/assets/js/39.2f5a06ea.js"><link rel="prefetch" href="/assets/js/4.63a5e966.js"><link rel="prefetch" href="/assets/js/40.dc834d41.js"><link rel="prefetch" href="/assets/js/41.fcc4e1e8.js"><link rel="prefetch" href="/assets/js/42.e57f8aa8.js"><link rel="prefetch" href="/assets/js/43.15534ad1.js"><link rel="prefetch" href="/assets/js/44.eb90d815.js"><link rel="prefetch" href="/assets/js/45.6e206fc8.js"><link rel="prefetch" href="/assets/js/46.285350f5.js"><link rel="prefetch" href="/assets/js/47.cde65c12.js"><link rel="prefetch" href="/assets/js/48.1c870c67.js"><link rel="prefetch" href="/assets/js/49.2b6f4336.js"><link rel="prefetch" href="/assets/js/5.2c45f22c.js"><link rel="prefetch" href="/assets/js/50.1a667582.js"><link rel="prefetch" href="/assets/js/51.600bc042.js"><link rel="prefetch" href="/assets/js/53.fa0284c4.js"><link rel="prefetch" href="/assets/js/54.0b748f22.js"><link rel="prefetch" href="/assets/js/55.ee05dee1.js"><link rel="prefetch" href="/assets/js/56.21abdcc3.js"><link rel="prefetch" href="/assets/js/57.26ddbf76.js"><link rel="prefetch" href="/assets/js/58.91fd9800.js"><link rel="prefetch" href="/assets/js/59.6022db72.js"><link rel="prefetch" href="/assets/js/6.e9b45abe.js"><link rel="prefetch" href="/assets/js/60.1f2889ae.js"><link rel="prefetch" href="/assets/js/61.46040c7d.js"><link rel="prefetch" href="/assets/js/62.af7e9fcd.js"><link rel="prefetch" href="/assets/js/63.2fb355ca.js"><link rel="prefetch" href="/assets/js/64.99a87693.js"><link rel="prefetch" href="/assets/js/65.005ae6f4.js"><link rel="prefetch" href="/assets/js/66.12940877.js"><link rel="prefetch" href="/assets/js/67.b4a93190.js"><link rel="prefetch" href="/assets/js/68.c8d9d13c.js"><link rel="prefetch" href="/assets/js/69.158d7968.js"><link rel="prefetch" href="/assets/js/7.bbffe35f.js"><link rel="prefetch" href="/assets/js/70.4e4a3ae3.js"><link rel="prefetch" href="/assets/js/71.487c7568.js"><link rel="prefetch" href="/assets/js/72.e2a65bcb.js"><link rel="prefetch" href="/assets/js/8.bda61152.js"><link rel="prefetch" href="/assets/js/9.f87a0e7d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.74a02103.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="个人主页" class="logo"> <span class="site-name can-hide">个人主页</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博客文章" class="dropdown-title"><span class="title">博客文章</span> <span class="arrow down"></span></button> <button type="button" aria-label="博客文章" class="mobile-dropdown-title"><span class="title">博客文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/test/" class="nav-link">
  测试
</a></li><li class="dropdown-item"><!----> <a href="/frontend/" class="nav-link router-link-active">
  前端
</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">
  linux
</a></li><li class="dropdown-item"><!----> <a href="/other/" class="nav-link">
  杂文
</a></li><li class="dropdown-item"><!----> <a href="/node/" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">
  Python
</a></li></ul></div></div><div class="nav-item"><a href="/readlog.html" class="nav-link">
  阅读日志
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div> <a href="https://github.com/JoeHR/vuePress-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="博客文章" class="dropdown-title"><span class="title">博客文章</span> <span class="arrow down"></span></button> <button type="button" aria-label="博客文章" class="mobile-dropdown-title"><span class="title">博客文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/test/" class="nav-link">
  测试
</a></li><li class="dropdown-item"><!----> <a href="/frontend/" class="nav-link router-link-active">
  前端
</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">
  linux
</a></li><li class="dropdown-item"><!----> <a href="/other/" class="nav-link">
  杂文
</a></li><li class="dropdown-item"><!----> <a href="/node/" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">
  Python
</a></li></ul></div></div><div class="nav-item"><a href="/readlog.html" class="nav-link">
  阅读日志
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div> <a href="https://github.com/JoeHR/vuePress-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>css</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>React学习</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend/react-react01.html" class="sidebar-link">react的相关知识点</a></li><li><a href="/frontend/react-style-jsx.html" aria-current="page" class="active sidebar-link">styled-jsx在 jsx 中得应用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend/react-style-jsx.html#styled-jsx" class="sidebar-link">styled-jsx</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend/react-style-jsx.html#_1-基础用法" class="sidebar-link">1. 基础用法</a></li><li class="sidebar-sub-header"><a href="/frontend/react-style-jsx.html#_2-动态css" class="sidebar-link">2. 动态css</a></li><li class="sidebar-sub-header"><a href="/frontend/react-style-jsx.html#_3-如何使用sass" class="sidebar-link">3. 如何使用Sass</a></li><li class="sidebar-sub-header"><a href="/frontend/react-style-jsx.html#_4-全局css" class="sidebar-link">4. 全局css</a></li><li class="sidebar-sub-header"><a href="/frontend/react-style-jsx.html#_5-三方ui库的支持" class="sidebar-link">5. 三方UI库的支持</a></li><li class="sidebar-sub-header"><a href="/frontend/react-style-jsx.html#_6-语法高亮与补完" class="sidebar-link">6. 语法高亮与补完</a></li><li class="sidebar-sub-header"><a href="/frontend/react-style-jsx.html#_7-大小-性能" class="sidebar-link">7. 大小？性能？</a></li><li class="sidebar-sub-header"><a href="/frontend/react-style-jsx.html#_8-style-jsx-vs-styled-components" class="sidebar-link">8. style-jsx vs styled-components</a></li></ul></li><li class="sidebar-sub-header"><a href="/frontend/react-style-jsx.html#最后" class="sidebar-link">最后</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue学习</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>性能</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试题</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="styled-jsx"><a href="#styled-jsx" class="header-anchor">#</a> <a href="https://github.com/zeit/styled-jsx" target="_blank" rel="noopener noreferrer">styled-jsx<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <p>zeit 的一系列产品从 now，到 next.js，我算是一个脑残粉。简洁好用是我对 zeit 的项目的印象。而且一套库自成系统，styled-jsx 和 next.js 完美兼容。</p> <h3 id="_1-基础用法"><a href="#_1-基础用法" class="header-anchor">#</a> 1. 基础用法</h3> <p>styled-jsx 概括第一印象就是 React css 的 vue 解决。
<code>yarn add styled-jsx</code> 安装后，不用<code>import</code>，而是一个babel插件，<code>.babelrc</code>配置：</p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;plugins&quot;: [
    &quot;styled-jsx/babel&quot;
  ]
}
复制代码
</code></pre></div><p>然后就直接用了</p> <div class="language- extra-class"><pre class="language-text"><code>render () {
    return &lt;div className='table'&gt;
        &lt;div className='row'&gt;
            &lt;div className='cell'&gt;A0&lt;/div&gt;
            &lt;div className='cell'&gt;B0&lt;/div&gt;
        &lt;/div&gt;
        &lt;style jsx&gt;{`
          .table {
            margin: 10px;
          }
          .row {
            border: 1px solid black;
          }
          .cell {
            color: red;
          }
    `}&lt;/style&gt;
    &lt;/div&gt;;
}
复制代码
</code></pre></div><ul><li>``的位置可以按喜好自定，样式总是作用于组件的所有元素</li> <li>样式只作用于本组件，不影响全局也不影响子组件</li> <li>实现方式大致是给组件内所有标签自动加上了一个独特<code>className</code> 例如</li></ul> <div class="language- extra-class"><pre class="language-text"><code>const App = () =&gt; (
  &lt;div&gt;
    &lt;p&gt;只有这个p会被上样式&lt;/p&gt;
    &lt;style jsx&gt;{`
      p {
        color: red;
      }
    `}&lt;/style&gt;
  &lt;/div&gt;
)
复制代码
</code></pre></div><p>会被转化成</p> <div class="language- extra-class"><pre class="language-text"><code>import _JSXStyle from 'styled-jsx/style'

const App = () =&gt; (
  &lt;div className='jsx-123'&gt;
    &lt;p className='jsx-123'&gt;只有这个p会被上样式&lt;/p&gt;
    &lt;_JSXStyle styleId='123' css={`p.jsx-123 {color: red;}`} /&gt;
  &lt;/div&gt;
)
复制代码
</code></pre></div><p>从实现到原理，对比vue是不是非常像呢？如果你不喜欢将样式写在 render 里，styled-jsx 提供了一个 <code>css</code> 的工具函数：</p> <div class="language- extra-class"><pre class="language-text"><code>import css from 'styled-jsx/css'

export default () =&gt; (
  &lt;div&gt;
    &lt;button&gt;styled-jsx&lt;/button&gt;
    &lt;style jsx&gt;{button}&lt;/style&gt;
  &lt;/div&gt;
)

const button = css`button { color: hotpink; }`
复制代码
</code></pre></div><p>非常完美的css解决方案。 下面针对“选择标准”里提到的各个方面考察一下 styled-jsx</p> <h3 id="_2-动态css"><a href="#_2-动态css" class="header-anchor">#</a> 2. 动态css</h3> <p>和 styled-components，Motion 等模板字符串的解决方案一样，动态css轻而易举</p> <div class="language- extra-class"><pre class="language-text"><code>export default (props) =&gt; (
  &lt;div&gt;
    &lt;button&gt;styled-jsx&lt;/button&gt;
    &lt;style jsx&gt;{
      `button { color: ${props.color}; }`
    }&lt;/style&gt;
  &lt;/div&gt;
)
复制代码
</code></pre></div><p>同个组件里可以写无限个``标签，这里的最佳实践是将静态的css放一个标签，动态的放另一个，每次渲染时只有动态的重新计算和渲染</p> <div class="language- extra-class"><pre class="language-text"><code>const Button = (props) =&gt; (
  &lt;button&gt;
     { props.children }
     &lt;style jsx&gt;{`
        button {
          color: #999;
          display: inline-block;
          font-size: 2em;
        }
     `}&lt;/style&gt;
     &lt;style jsx&gt;{`
        button {
          padding: ${ 'large' in props ? '50' : '20' }px;
          background: ${props.theme.background};
        }
     `}&lt;/style&gt;
  &lt;/button&gt;
)
复制代码
</code></pre></div><p>两点注意：</p> <ul><li>只有写在 render 函数里的style是动态的，所以动态css不能如第二例那样提取出来</li> <li>原声解决方法的 style props的样式会覆盖 styled-jsx 的样式</li></ul> <h3 id="_3-如何使用sass"><a href="#_3-如何使用sass" class="header-anchor">#</a> 3. 如何使用Sass</h3> <p>两个字，插件。</p> <ul><li><a href="https://github.com/giuseppeg/styled-jsx-plugin-sass" target="_blank" rel="noopener noreferrer">styled-jsx-plugin-sass<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/giuseppeg/styled-jsx-plugin-postcss" target="_blank" rel="noopener noreferrer">styled-jsx-plugin-postcss<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/giuseppeg/styled-jsx-plugin-stylelint" target="_blank" rel="noopener noreferrer">styled-jsx-plugin-stylelint<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/erasmo-marin/styled-jsx-plugin-less" target="_blank" rel="noopener noreferrer">styled-jsx-plugin-less<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/omardelarosa/styled-jsx-plugin-stylus" target="_blank" rel="noopener noreferrer">styled-jsx-plugin-stylus<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>一应俱全。以Sass为例：</p> <div class="language- extra-class"><pre class="language-text"><code>yarn add -D node-sass styled-jsx-plugin-sass
复制代码
</code></pre></div><p><code>.babelrc</code>配置</p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;plugins&quot;: [
    [
      &quot;styled-jsx/babel&quot;,
      { &quot;plugins&quot;: [&quot;styled-jsx-plugin-sass&quot;] }
    ]
  ]
}
复制代码
</code></pre></div><p>即可使用Sass。</p> <h3 id="_4-全局css"><a href="#_4-全局css" class="header-anchor">#</a> 4. 全局css</h3> <p>如同 Vue 以 <code>scoped</code> 为关键字，styled-jsx 以 <code>global</code> 为关键字。</p> <div class="language- extra-class"><pre class="language-text"><code>export default () =&gt; (
  &lt;div&gt;
    &lt;style jsx global&gt;{`
      body {
        background: red
      }
    `}&lt;/style&gt;
  &lt;/div&gt;
)
复制代码
</code></pre></div><p>全局样式注明 global 即可。</p> <p>有极少情况（比如传一个全局类给三方库）需要使单个选择器全局化，语法类似 css-module</p> <div class="language- extra-class"><pre class="language-text"><code>div :global(.react-select) {
    color: red
}
复制代码
</code></pre></div><h3 id="_5-三方ui库的支持"><a href="#_5-三方ui库的支持" class="header-anchor">#</a> 5. 三方UI库的支持</h3> <p>相对有点繁琐，思想是取得styled-jsx转化过后的类名，注入到三方库的className props里，这样即解决了支持，又保全了局部css，代码如下</p> <div class="language- extra-class"><pre class="language-text"><code>import Link from 'react-router-dom' // 例子，给Link组件添加样式

const scoped = resolveScopedStyles(
  &lt;scope&gt;
    &lt;style jsx&gt;{'.link { color: green }'}&lt;/style&gt;
  &lt;/scope&gt;
)

const App = ({ children }) =&gt; (
  &lt;div&gt;
    {children}
    &lt;Link to=&quot;/about&quot; className={`link ${scoped.className}`}&gt;
      About
    &lt;/Link&gt;

    {scoped.styles}
  &lt;/div&gt;
);

function resolveScopedStyles(scope) {
  return {
    className: scope.props.className, //就是被styled-jsx添加的独特className
    styles: scope.props.children      //就是style，注入到App组件中
  }
}
复制代码
</code></pre></div><p>当然，如果你不介意局部不局部，可以使用上面提到的<code>:global()</code> 语法</p> <div class="language- extra-class"><pre class="language-text"><code>// 比如Form组件有类名form-item
export default () =&gt; (
  &lt;div&gt;
    &lt;Form /&gt;
    &lt;style jsx&gt;{`
      div &gt; :global(.form-item) {
        color: red
      }
    `}&lt;/style&gt;
  &lt;/div&gt;
)
复制代码
</code></pre></div><h3 id="_6-语法高亮与补完"><a href="#_6-语法高亮与补完" class="header-anchor">#</a> 6. 语法高亮与补完</h3> <p>我使用VSCode：</p> <ul><li><a href="https://marketplace.visualstudio.com/items?itemName=blanu.vscode-styled-jsx" target="_blank" rel="noopener noreferrer">语法高亮<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://marketplace.visualstudio.com/items?itemName=AndrewRazumovsky.vscode-styled-jsx-languageserver" target="_blank" rel="noopener noreferrer">自动补完<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>其他的见 github 上 readme。</p> <h3 id="_7-大小-性能"><a href="#_7-大小-性能" class="header-anchor">#</a> 7. 大小？性能？</h3> <ul><li>可使用所有css语法</li> <li>3kb的gzip大小</li> <li>浏览器的prefix自动加了</li> <li>有source-map 支持，方便debug</li> <li>据作者说性能也很高</li></ul> <h3 id="_8-style-jsx-vs-styled-components"><a href="#_8-style-jsx-vs-styled-components" class="header-anchor">#</a> 8. style-jsx vs styled-components</h3> <p>谢谢ziven27提议，我试着说说和现在最流行的 styled-components 库的区别。（方便讨论，“前者”代指style-jsx，“后者”代指style-components）</p> <ul><li>最大区别在于前者样式作用于整个组件，后者的样式只作用于所包裹的元素。打个比方就如同vue和inline css的区别。但其实只要使用sass的<code>&amp;</code>嵌套，后者也是可以包裹组件最外层元素然后将其他元素样式统统写入的。虽然感觉不是后者的初衷。</li> <li>后者与提供<code>className</code> props的三方库完美整合（比前者简洁太多）：</li></ul> <div class="language- extra-class"><pre class="language-text"><code>const RedButton = styled(Button)`background: red;`
复制代码
</code></pre></div><p>但对不提供<code>className</code> props的三方库一筹莫展（当然这种情况不太出现）。</p> <ul><li>后者由于使用了HOC模式，与其他所有HOC一样要处理ref的问题（包裹层的ref不同于原本元素的ref），多一事。</li> <li>个人觉得前者的规则简洁明了（css怎么写就怎么写），后者有不少“魔术”的部分（比如props，theme），也引入了很多高级用法如<code>.extends</code> 样式继承以及<code>.attrs</code>封装公用props。</li></ul> <p>这里提到一个话题，到底是“魔术”好呢，还是朴实好呢？举个例子，比如theme（主题）：</p> <div class="language- extra-class"><pre class="language-text"><code>// styled-components 使用Provider提供主题，主题可以是样式，也可以是函数
const Button = styled.button`
  color: ${props =&gt; props.theme.fg};
  border: 2px solid ${props =&gt; props.theme.fg};
  background: ${props =&gt; props.theme.bg};

  font-size: 1em;
  margin: 1em;
  padding: 0.25em 1em;
  border-radius: 3px;
`;

// 主题的样式
const theme = {
  fg: 'palevioletred',
  bg: 'white'
};

// 换前景色和背景色的函数
const invertTheme = ({ fg, bg }) =&gt; ({
  fg: bg,
  bg: fg
});

render(
  &lt;ThemeProvider theme={theme}&gt;
    &lt;div&gt;
      &lt;Button&gt;Default Theme&lt;/Button&gt;

      &lt;ThemeProvider theme={invertTheme}&gt;
        &lt;Button&gt;Inverted Theme&lt;/Button&gt;
      &lt;/ThemeProvider&gt;
    &lt;/div&gt;
  &lt;/ThemeProvider&gt;
);
复制代码
</code></pre></div><p>甚至还提供了一个HOC，在styled-components外使用theme</p> <div class="language- extra-class"><pre class="language-text"><code>import { withTheme } from 'styled-components'
复制代码
</code></pre></div><p>强大不强大？对比之下，styled-jsx没有任何与theme相关的api，只是朴朴实实地靠props传递达成主题：</p> <div class="language- extra-class"><pre class="language-text"><code>// styled-jsx
import { colors, spacing } from '../theme'
import { invertColor } from '../theme/utils'

const Button = ({ children }) =&gt; (
  &lt;button&gt;
     { children }
     &lt;style jsx&gt;{`
        button {
          padding: ${ spacing.medium };
          background: ${ colors.primary };
          color: ${ invertColor(colors.primary) };
        }
     `}&lt;/style&gt;
  &lt;/button&gt;
)
复制代码
</code></pre></div><p>这个问题要看应用场景和个人喜好吧，我属于不喜欢过多“魔术”，爱简单api（哪怕多点代码）的那派。大家有啥想法和指正，多多留言。</p> <h2 id="最后"><a href="#最后" class="header-anchor">#</a> 最后</h2> <p>有2个细小缺点</p> <ol><li>和CRA整合时，css-in-js 的解决方式不会热加载，每次都刷新页面。</li> <li>和CRA整合时，由于是babel插件，需要eject或者使用<a href="https://github.com/timarney/react-app-rewired" target="_blank" rel="noopener noreferrer"><code>react-app-rewired</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>来加入 babel plugin 的设置。</li></ol> <p>之前有小伙伴留言表示有坑（谢谢，看到这样的留言觉得写blog的决定太对了）</p> <div class="language- extra-class"><pre class="language-text"><code>同样觉得styled-jsx非常好，最近一直在用。
但目前还是有些不成熟的地方，主要是：
1、局部样式无法支持第三方组件标签，只能支持普通html标签
2、对stylelint缺乏支持，官方出的stylelint插件只是一个demo。在vscode中用stylelint插件时也是有很大的坑。
复制代码
</code></pre></div><!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">2/21/2022, 3:29:09 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/frontend/react-react01.html" class="prev">
        react的相关知识点
      </a></span> <span class="next"><a href="/frontend/vue-vue01.html">
        vue源码学习笔记01
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.f8839a88.js" defer></script><script src="/assets/js/2.8d06e467.js" defer></script><script src="/assets/js/52.2e105d94.js" defer></script>
  </body>
</html>
